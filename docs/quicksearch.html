<html>
<head>
</head>
<body style="background: transparent;">
    <script src="scripts/docstrap.lib.js"></script>
    <script src="scripts/lunr.min.js"></script>
    <script src="scripts/fulltext-search.js"></script>

    <script type="text/x-docstrap-searchdb">
    {"classes.list.html":{"id":"classes.list.html","title":"Classes","body":" Documentation Classes ServicePlugin Events event:@midgar/service:afterLoad Classes Classes ServicePlugin Events @midgar/service:afterLoad afterLoad event. × Search results Close Documentation generated by JSDoc 3.6.3 on 2020-01-04T23:44:51+00:00 using the DocStrap template. "},"index.html":{"id":"index.html","title":"Index","body":" Documentation Classes ServicePlugin Events event:@midgar/service:afterLoad @midgar/service Système de services avec injection de dépendance pour Midgar Installation $ npm i @midgar/service --save Si tout s'est bien passé, un message de confirmation s'affiche: #midgar-cli @midgar/express added to plugins.js ! Fonctionnement Ajoute un dossier de plugin midgar-services: ./services/. Les services sont chargés a l'appel de l'évènement @midgar/midgar:afterLoadPlugins Ficher service Function: export default { // Nom du service name: 'namespace:monService', // Le service s'initialiseras avant le service mid:express before: ['mid:express'] // Service a injecter dependencies: [ 'mid:mongo' ], service: (mid, mongoService) =&gt; { ... } } Class: // Nom du service const name = 'namespace:monService' // Le service s'initialiseras avant le service mid:express const before = ['mid:express'] // Service a injecter const dependencies: [ 'mid:mongo' ] class MyService { constructor(mid, mongoService) {} init () { ... } } export default { name before, dependencies, service: MyService, } La methode init est appelé automatique lors de la création de l'instance du service. Get service const serviceInstance = mid.getService('namespace:monService') × Search results Close Documentation generated by JSDoc 3.6.3 on 2020-01-04T23:44:51+00:00 using the DocStrap template. "},"ServicePlugin.html":{"id":"ServicePlugin.html","title":"Class: ServicePlugin","body":" Documentation Classes ServicePlugin Events event:@midgar/service:afterLoad Class: ServicePlugin ServicePlugin Midgar Service plugin new ServicePlugin() Members _services :Object Service instance object Type: Object dirKey :String Services dir key Type: String Methods _checkServiceDef(serviceDef, file) Check service Object def Parameters: Name Type Description serviceDef Obejct Service Object definition file Object Object file from pm.importDir &lt;async&gt; _getServiceDefs() Return an object with all plugin services Returns: Type Object _proccessBeforeDef(serviceDef, beforeServices, file) Check in service def if before services exist and map them Parameters: Name Type Description serviceDef Obejct Service Object definition beforeServices Store service before index file Object Object file from pm.importDir getService(name) Return a service instance Parameters: Name Type Description name String Service name Returns: Type Object init() Init plugin × Search results Close Documentation generated by JSDoc 3.6.3 on 2020-01-04T23:44:51+00:00 using the DocStrap template. "}}
    </script>

    <script type="text/javascript">
        $(document).ready(function() {
            Searcher.init();
        });

        $(window).on("message", function(msg) {
            var msgData = msg.originalEvent.data;

            if (msgData.msgid != "docstrap.quicksearch.start") {
                return;
            }

            var results = Searcher.search(msgData.searchTerms);

            window.parent.postMessage({"results": results, "msgid": "docstrap.quicksearch.done"}, "*");
        });
    </script>
</body>
</html>
